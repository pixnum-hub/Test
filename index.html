<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Weather AI</title>

<style>
:root{
  --bg:#f4f4f4;
  --card:#ffffff;
  --text:#000000;
}

body{
  margin:0;
  font-family: Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
  display:flex;
  justify-content:center;
}

.container{
  max-width:500px;
  width:100%;
  padding:15px;
}

h1{
  text-align:center;
  font-size:28px;
}

.card{
  background:var(--card);
  padding:15px;
  margin-top:15px;
  border-radius:15px;
}

.scroll{
  display:flex;
  overflow-x:auto;
  gap:10px;
  padding:10px 0;
}

.item{
  min-width:80px;
  padding:10px;
  background:rgba(0,0,0,0.05);
  border-radius:10px;
  text-align:center;
  font-size:16px;
}

button{
  padding:8px 12px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

.footer{
  text-align:center;
  margin-top:30px;
  font-size:14px;
  opacity:0.7;
}

/* Modes */
.light{ --bg:#f4f4f4; --card:#ffffff; --text:#000; }
.dark{ --bg:#121212; --card:#1e1e1e; --text:#ffffff; }
.oled{ --bg:#000000; --card:#000000; --text:#ffffff; }
</style>
</head>

<body class="light">

<div class="container">

<h1>Smart Weather AI</h1>

<div class="card">
<input type="text" id="cityInput" placeholder="Search city">
<button onclick="searchCity()">Search</button>
<button onclick="toggleMode()">Mode</button>
<p id="locationInfo"></p>
</div>

<div class="card" id="currentWeather"></div>

<div class="card">
<h3>24 Hour Temperature</h3>
<div class="scroll" id="hourlyTemp"></div>
</div>

<div class="card">
<h3>7 Day Temperature</h3>
<div class="scroll" id="dailyTemp"></div>
</div>

<div class="footer">
Â© Manik Roy <span id="year"></span>. All Rights Reserved.
</div>

</div>

<script>
document.getElementById("year").innerText = new Date().getFullYear();

let modeIndex = 0;
function toggleMode(){
  const modes = ["light","dark","oled"];
  document.body.className = modes[modeIndex];
  modeIndex = (modeIndex+1)%3;
}

async function searchCity(){
  let city = document.getElementById("cityInput").value;
  let geo = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${city}`);
  let geoData = await geo.json();
  if(!geoData.results) return alert("City not found");
  let lat = geoData.results[0].latitude;
  let lon = geoData.results[0].longitude;
  let name = geoData.results[0].name;
  let country = geoData.results[0].country;
  document.getElementById("locationInfo").innerText = `${name}, ${country}`;
  loadWeather(lat,lon);
}

async function loadWeather(lat,lon){
  let url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m,relative_humidity_2m,dew_point_2m,precipitation&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,sunrise,sunset&current_weather=true&timezone=auto`;
  let res = await fetch(url);
  let data = await res.json();

  let t = data.current_weather.temperature;
  let humidity = data.hourly.relative_humidity_2m[0];
  let dew = data.hourly.dew_point_2m[0];

  let feelsLike = t;
  if(t >= 27){
    feelsLike = Math.round(t + (0.33 * humidity/100 * 6) - 0.7);
  }

  let comfortScore = Math.max(0,100 - Math.abs(feelsLike-24)*4);

  let rain24 = data.hourly.precipitation.slice(0,24)
    .reduce((a,b)=>a+b,0).toFixed(1);

  let rain7 = data.daily.precipitation_sum
    .reduce((a,b)=>a+b,0).toFixed(1);

  let rainType = "No rain";
  if(rain24 > 20) rainType="Heavy";
  else if(rain24 > 5) rainType="Moderate";
  else if(rain24 > 0) rainType="Drizzle";

  let acTemp = 26;
  if(feelsLike>35) acTemp=22;
  else if(feelsLike>30) acTemp=24;
  else if(feelsLike>26) acTemp=25;

  let power = (1.5 * (26-acTemp)/10 * 8).toFixed(1);

  document.getElementById("currentWeather").innerHTML=`
  ðŸŒ¡ Temp: ${t}Â°C<br>
  ðŸŒ¡ Feels Like: ${feelsLike}Â°C<br>
  ðŸ’§ Humidity: ${humidity}%<br>
  ðŸŒ« Dew Point: ${dew}Â°C<br>
  ðŸ¤– Comfort Score: ${comfortScore}%<br><br>

  ðŸŒ§ 24h Rain: ${rain24} mm<br>
  ðŸŒŠ 7 Day Rain: ${rain7} mm<br>
  â˜” Rain Type: ${rainType}<br><br>

  ðŸŒ… Sunrise: ${data.daily.sunrise[0].split("T")[1]}<br>
  ðŸŒ‡ Sunset: ${data.daily.sunset[0].split("T")[1]}<br><br>

  ðŸŽ› Recommended AC Temp: ${acTemp}Â°C<br>
  âš¡ Estimated Usage: ${power} kWh/day
  `;

  let hourlyDiv = document.getElementById("hourlyTemp");
  hourlyDiv.innerHTML="";
  for(let i=0;i<24;i++){
    hourlyDiv.innerHTML+=`
    <div class="item">
    ${data.hourly.time[i].split("T")[1]}<br>
    ${data.hourly.temperature_2m[i]}Â°C
    </div>`;
  }

  let dailyDiv = document.getElementById("dailyTemp");
  dailyDiv.innerHTML="";
  for(let i=0;i<7;i++){
    dailyDiv.innerHTML+=`
    <div class="item">
    ${data.daily.time[i]}<br>
    ${data.daily.temperature_2m_max[i]}Â°C
    </div>`;
  }
}
</script>

</body>
</html>
