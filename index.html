<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tactical GPS System</title>

<link rel="manifest" href="manifest.json">

<style>
:root{
  --bg:#0a0f1c;
  --glass:rgba(255,255,255,0.08);
  --border:rgba(255,255,255,0.2);
  --text:#ffffff;
  --accent:#00ff88;
}

body{
  margin:0;
  background:linear-gradient(135deg,#0a0f1c,#111a2f);
  font-family:Arial, sans-serif;
  color:var(--text);
  display:flex;
  justify-content:center;
}

.app-frame{
  width:100%;
  max-width:420px;
  border:2px solid var(--border);
  border-radius:20px;
  margin:20px;
  padding:20px;
  backdrop-filter:blur(15px);
  background:var(--glass);
  box-shadow:0 0 30px rgba(0,255,136,0.2);
  display:flex;
  flex-direction:column;
  align-items:center;
}

.top-toggle{
  position:absolute;
  right:25px;
  top:25px;
}

.toggle-btn{
  width:50px;
  height:50px;
  border-radius:50%;
  border:none;
  background:var(--accent);
  cursor:pointer;
}

h2{
  text-align:center;
  margin-bottom:10px;
}

.section{
  width:100%;
  margin:10px 0;
}

input,button{
  width:100%;
  padding:10px;
  margin:5px 0;
  border-radius:8px;
  border:none;
  text-align:center;
}

button{
  background:var(--accent);
  font-weight:bold;
  cursor:pointer;
}

canvas{
  background:#000;
  border-radius:10px;
  width:100%;
}

.footer{
  margin-top:20px;
  text-align:center;
  font-size:12px;
  opacity:0.7;
}
</style>
</head>

<body>

<div class="app-frame">

<div class="top-toggle">
  <button class="toggle-btn" onclick="toggleMode()">ðŸŒ™</button>
</div>

<h2>ðŸ›° Tactical GPS System</h2>

<div class="section">
  <div id="coords">Waiting for GPS...</div>
  <div id="utm"></div>
  <div id="nato"></div>
</div>

<div class="section">
  <button onclick="startTracking()">Start Tracking</button>
  <button onclick="replayTrack()">Replay Track</button>
</div>

<div class="section">
  <button onclick="addWaypoint()">Add Waypoint</button>
</div>

<div class="section">
  <input type="number" id="velocity" placeholder="Velocity (m/s)">
  <input type="number" id="angle" placeholder="Angle (Â°)">
  <button onclick="calcBallistic()">Calculate Ballistic</button>
  <div id="ballistic"></div>
</div>

<div class="section">
  <input type="number" id="windSpeed" placeholder="Wind Speed (m/s)">
  <input type="number" id="windDir" placeholder="Wind Direction (Â°)">
  <button onclick="applyWind()">Apply Wind Correction</button>
  <div id="windResult"></div>
</div>

<div class="section">
  <canvas id="compass" height="200"></canvas>
</div>

<div class="footer">
Â© Manik Roy <span id="year"></span>. All Rights Reserved.
</div>

</div>

<script>
document.getElementById("year").textContent = new Date().getFullYear();

let track=[];
let waypoints=[];
let currentHeading=0;

const a=6378137.0;
const f=1/298.257223563;
const k0=0.9996;
const e=Math.sqrt(f*(2-f));

navigator.geolocation.watchPosition(pos=>{
  const lat=pos.coords.latitude;
  const lon=pos.coords.longitude;
  currentHeading=pos.coords.heading||0;

  document.getElementById("coords").innerHTML=
  `Lat: ${lat.toFixed(6)}<br>Lon: ${lon.toFixed(6)}`;

  const utm=latLonToUTM(lat,lon);
  document.getElementById("utm").innerHTML=
  `UTM Zone ${utm.zone}<br>E: ${utm.easting.toFixed(2)}<br>N: ${utm.northing.toFixed(2)}`;

  document.getElementById("nato").innerHTML=
  formatNATO(utm.zone,utm.easting,utm.northing);

  drawCompass(currentHeading);
});

function latLonToUTM(lat,lon){
  const zone=Math.floor((lon+180)/6)+1;
  const Î»0=((zone-1)*6-180+3)*Math.PI/180;
  const Ï†=lat*Math.PI/180;
  const Î»=lon*Math.PI/180;
  const N=a/Math.sqrt(1-Math.pow(e*Math.sin(Ï†),2));
  const T=Math.pow(Math.tan(Ï†),2);
  const C=Math.pow(e*Math.cos(Ï†),2)/(1-e*e);
  const A=(Î»-Î»0)*Math.cos(Ï†);
  const M=a*((1-e*e/4)*Ï†);
  const easting=k0*N*(A+(1-T+C)*Math.pow(A,3)/6)+500000;
  const northing=k0*(M+N*Math.tan(Ï†)*(A*A/2));
  return {zone,easting,northing};
}

function formatNATO(zone,easting,northing){
  return `NATO: ${zone}Q ${Math.floor(easting)}E ${Math.floor(northing)}N`;
}

function startTracking(){
  track=[];
  alertSound();
}

function addWaypoint(){
  waypoints.push(track[track.length-1]);
  localStorage.setItem("waypoints",JSON.stringify(waypoints));
  alertSound();
}

function replayTrack(i=0){
  if(i>=track.length) return;
  document.getElementById("coords").innerHTML=
  `Replay: ${track[i].lat}, ${track[i].lon}`;
  setTimeout(()=>replayTrack(i+1),500);
}

function calcBallistic(){
  const v=parseFloat(document.getElementById("velocity").value);
  const angle=parseFloat(document.getElementById("angle").value);
  const g=9.81;
  const Î¸=angle*Math.PI/180;
  const range=(v*v*Math.sin(2*Î¸))/g;
  const height=(v*v*Math.pow(Math.sin(Î¸),2))/(2*g);
  document.getElementById("ballistic").innerHTML=
  `Range: ${range.toFixed(2)} m<br>Max Height: ${height.toFixed(2)} m`;
}

function applyWind(){
  const ws=parseFloat(document.getElementById("windSpeed").value);
  const wd=parseFloat(document.getElementById("windDir").value);
  const headingRad=currentHeading*Math.PI/180;
  const windRad=wd*Math.PI/180;
  const x=ws*Math.cos(windRad);
  const y=ws*Math.sin(windRad);
  const corrected=Math.atan2(y,x)*180/Math.PI;
  document.getElementById("windResult").innerHTML=
  `Wind Adjusted Heading: ${corrected.toFixed(2)}Â°`;
}

function drawCompass(angle){
  const c=document.getElementById("compass");
  const ctx=c.getContext("2d");
  ctx.clearRect(0,0,c.width,c.height);
  ctx.beginPath();
  ctx.arc(100,100,80,0,2*Math.PI);
  ctx.strokeStyle="#00ff88";
  ctx.stroke();
  ctx.save();
  ctx.translate(100,100);
  ctx.rotate(angle*Math.PI/180);
  ctx.beginPath();
  ctx.moveTo(0,-70);
  ctx.lineTo(0,70);
  ctx.strokeStyle="red";
  ctx.stroke();
  ctx.restore();
}

function toggleMode(){
  document.body.style.background=
  document.body.style.background==="black"
  ?"linear-gradient(135deg,#0a0f1c,#111a2f)"
  :"black";
}

function alertSound(){
  const audio=new Audio("data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=");
  audio.play();
}
</script>

</body>
</html>